!function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(g){var o=/\S/g,C=String.prototype.repeat||function(e){return Array(e+1).join(this)};function l(n){if(n.getOption("disableInput"))return g.Pass;for(var e,t=n.listSelections(),o=[],i=0;i<t.length;i++){var l=t[i].head;if(!/\bcomment\b/.test(n.getTokenTypeAt(l)))return g.Pass;var r=n.getModeAt(l);if(e){if(e!=r)return g.Pass}else e=r;var c,f,a=null,m=e.blockCommentStart,u=e.lineComment;if(m&&e.blockCommentContinue){var s=(c=n.getLine(l.line)).lastIndexOf(e.blockCommentEnd,l.ch-e.blockCommentEnd.length);if(!(-1!=s&&s==l.ch-e.blockCommentEnd.length||u&&-1<(f=c.lastIndexOf(u,l.ch-1))&&/\bcomment\b/.test(n.getTokenTypeAt({line:l.line,ch:f+1}))))if(l.ch>=m.length&&-1<(f=c.lastIndexOf(m,l.ch-m.length))&&s<f)if(v(0,c)>=f)a=c.slice(0,f);else{var d,p=n.options.tabSize;f=g.countColumn(c,f,p),a=n.options.indentWithTabs?C.call("\t",d=Math.floor(f/p))+C.call(" ",f-p*d):C.call(" ",f)}else-1<(f=c.indexOf(e.blockCommentContinue))&&f<=l.ch&&f<=v(0,c)&&(a=c.slice(0,f));null!=a&&(a+=e.blockCommentContinue)}if(null==a&&u&&y(n))if(null==c&&(c=n.getLine(l.line)),f=c.indexOf(u),l.ch||f){if(-1<f&&v(0,c)>=f){if(!(a=-1<v(l.ch,c))){var h=n.getLine(l.line+1)||"",b=h.indexOf(u);a=-1<b&&v(0,h)>=b||null}a=a&&c.slice(0,f)+u+c.slice(f+u.length).match(/^\s*/)[0]}}else a="";if(null==a)return g.Pass;o[i]="\n"+a}n.operation(function(){for(var e=t.length-1;0<=e;e--)n.replaceRange(o[e],t[e].from(),t[e].to(),"+insert")})}function v(e,n){o.lastIndex=e;var t=o.exec(n);return t?t.index:-1}function y(e){var n=e.getOption("continueComments");return!n||"object"!=typeof n||!1!==n.continueLineComment}g.defineOption("continueComments",null,function(e,n,t){if(t&&t!=g.Init&&e.removeKeyMap("continueComment"),n){var o="Enter";"string"==typeof n?o=n:"object"==typeof n&&n.key&&(o=n.key);var i={name:"continueComment"};i[o]=l,e.addKeyMap(i)}})});